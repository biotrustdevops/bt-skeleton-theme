{% comment %}
  Collection page template matching the BioTRUST design reference
{% endcomment %}

{% liquid
  assign products_per_page = section.settings.products_per_page | default: 20
  assign collection_title = collection.title | default: 'All Products'
%}

<div class="collection-page">
  <!-- Collection Header -->
  <div class="collection-header bg-[#005eb8] text-white py-6">
    <div class="md:container md:mx-auto px-4 md:px-4">
      <h1 class="text-3xl lg:text-4xl font-bold">{{ collection_title }}</h1>
    </div>
  </div>

  <!-- Products Grid -->
  <div class="md:container md:mx-auto px-4 md:px-4 py-8">
    {% paginate collection.products by products_per_page %}
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5">
        {% for product in collection.products %}
          {% render 'product-card', 
            product: product,
            button_text: 'LEARN MORE',
            show_rating: true,
            use_yotpo: false
          %}
        {% endfor %}
      </div>

      <!-- Pagination -->
      {% if paginate.pages > 1 %}
        <div class="pagination-wrapper mt-12">
          {{ paginate | default_pagination }}
        </div>
      {% endif %}
    {% endpaginate %}
  </div>
</div>

<script>
  function addToCart(variantId) {
    fetch('/cart/add.js', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        items: [{
          id: variantId,
          quantity: 1
        }]
      })
    })
    .then(response => response.json())
    .then(data => {
      // Show success message or update cart icon
      console.log('Added to cart:', data);
      // You can add a toast notification here
      alert('Product added to cart!');
    })
    .catch(error => {
      console.error('Error adding to cart:', error);
      alert('Error adding product to cart');
    });
  }
</script>

{% schema %}
{
  "name": "Collection",
  "settings": [
    {
      "type": "range",
      "id": "products_per_page",
      "label": "Products per page",
      "min": 12,
      "max": 48,
      "step": 4,
      "default": 20
    }
  ]
}
{% endschema %}
