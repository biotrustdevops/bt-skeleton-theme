{% liquid
  assign heading_text = section.settings.heading_text | default: 'Shop by Healthy Aging Category'
%}

<section class="py-12 md:py-16 bg-gray-50" data-section-id="{{ section.id }}">
  <div class="container mx-auto px-4">
    {% if heading_text != blank %}
      <h2 class="text-3xl md:text-4xl lg:text-5xl font-bold text-[#005eb8] text-center mb-10 md:mb-14">{{ heading_text }}</h2>
    {% endif %}
    
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6 md:gap-8">
      {% for block in section.blocks %}
        {% case block.type %}
          {% when 'category' %}
            <div class="flex flex-col items-center" {{ block.shopify_attributes }}>
              {% liquid
                # Use default image from assets if no custom image is set
                assign has_custom_image = false
                if block.settings.product_image != blank
                  assign has_custom_image = true
                  assign product_image = block.settings.product_image
                elsif block.settings.default_image != blank
                  assign default_image_path = block.settings.default_image | append: '.png'
                  assign product_image_url = default_image_path | asset_url
                endif
              %}
              
              {% if has_custom_image or product_image_url %}
                <div class="w-full aspect-square mb-4">
                  {% if has_custom_image %}
                    <img 
                      src="{{ product_image | image_url: width: 400 }}"
                      srcset="{{ product_image | image_url: width: 200 }} 200w,
                              {{ product_image | image_url: width: 300 }} 300w,
                              {{ product_image | image_url: width: 400 }} 400w"
                      sizes="(max-width: 640px) 150px, (max-width: 768px) 180px, 200px"
                      alt="{{ block.settings.image_alt | default: block.settings.category_name }}"
                      width="{{ product_image.width }}"
                      height="{{ product_image.height }}"
                      loading="lazy"
                      class="w-full h-full object-contain"
                    >
                  {% elsif product_image_url %}
                    <img 
                      src="{{ product_image_url }}"
                      alt="{{ block.settings.image_alt | default: block.settings.category_name }}"
                      width="400"
                      height="400"
                      loading="lazy"
                      class="w-full h-full object-contain"
                    >
                  {% endif %}
                </div>
              {% endif %}
              
              {% if block.settings.button_text and block.settings.button_link %}
                <a href="{{ block.settings.button_link }}" 
                   class="inline-block px-6 py-3 bg-gray-200 hover:bg-gray-300 text-[#005eb8] font-bold text-sm uppercase rounded transition-colors duration-200">
                  {{ block.settings.button_text }}
                </a>
              {% endif %}
            </div>
        {% endcase %}
      {% endfor %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Healthy Aging Categories",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading_text",
      "label": "Heading Text",
      "default": "Shop by Healthy Aging Category"
    }
  ],
  "blocks": [
    {
      "type": "category",
      "name": "Category",
      "settings": [
        {
          "type": "select",
          "id": "default_image",
          "label": "Default Image",
          "default": "",
          "options": [
            { "value": "", "label": "None" },
            { "value": "health_aging_category-1-Collagen-Protein", "label": "Collagen Protein" },
            { "value": "health_aging_category-2-Protein-Powder", "label": "Protein Powder" },
            { "value": "health_aging_category-3-GLP-1-Support", "label": "GLP-1 Support" },
            { "value": "health_aging_category-4-Muscle-and-Joint", "label": "Muscle and Joint" },
            { "value": "health_aging_category-5-Weight-and-Metabolism", "label": "Weight and Metabolism" },
            { "value": "health_aging_category-6-Cognititve-Health", "label": "Cognitive Health" }
          ],
          "info": "Select a default image from the theme assets (includes hexagon design and text)"
        },
        {
          "type": "image_picker",
          "id": "product_image",
          "label": "Custom Image",
          "info": "Upload a custom image with hexagon design (overrides default selection)"
        },
        {
          "type": "text",
          "id": "image_alt",
          "label": "Image Alt Text",
          "info": "Describes the image for accessibility"
        },
        {
          "type": "text",
          "id": "category_name",
          "label": "Category Name (for alt text)",
          "info": "Used for alt text if not specified"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button Text",
          "default": "SHOP NOW"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Healthy Aging Categories",
      "blocks": [
        {
          "type": "category",
          "settings": {
            "default_image": "health_aging_category-1-Collagen-Protein",
            "category_name": "COLLAGEN PROTEIN",
            "button_text": "SHOP NOW"
          }
        },
        {
          "type": "category",
          "settings": {
            "default_image": "health_aging_category-2-Protein-Powder",
            "category_name": "PROTEIN POWDER",
            "button_text": "SHOP NOW"
          }
        },
        {
          "type": "category",
          "settings": {
            "default_image": "health_aging_category-3-GLP-1-Support",
            "category_name": "GLP-1 SUPPORT",
            "button_text": "SHOP NOW"
          }
        },
        {
          "type": "category",
          "settings": {
            "default_image": "health_aging_category-4-Muscle-and-Joint",
            "category_name": "MUSCLE AND JOINT",
            "button_text": "SHOP NOW"
          }
        },
        {
          "type": "category",
          "settings": {
            "default_image": "health_aging_category-5-Weight-and-Metabolism",
            "category_name": "WEIGHT AND METABOLISM",
            "button_text": "SHOP NOW"
          }
        },
        {
          "type": "category",
          "settings": {
            "default_image": "health_aging_category-6-Cognititve-Health",
            "category_name": "COGNITIVE HEALTH",
            "button_text": "SHOP NOW"
          }
        }
      ]
    }
  ]
}
{% endschema %}