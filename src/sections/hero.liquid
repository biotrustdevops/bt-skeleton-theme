{% liquid
  # Date-based hero logic for time-sensitive campaigns
  assign today = "today" | date: "%s" | default: 0 | plus: 0
  assign default_hero = null
  assign active_hero = null
  
  for block in section.blocks
    if block.settings.is_default_hero
      assign default_hero = block
    endif
    
    unless block.settings.is_default_hero
      assign start_date = block.settings.start_date | date: '%s' | default: 0 | plus: 0
      assign end_date = block.settings.end_date | date: '%s' | default: 0 | plus: 0
      
      if start_date < today and end_date > today
        assign active_hero = block
        break
      endif
    endunless
  endfor
  
  # Use active hero if found, otherwise use default
  if active_hero
    assign hero = active_hero
  elsif default_hero
    assign hero = default_hero
  elsif section.blocks.first
    assign hero = section.blocks.first
  endif
%}

{% if hero %}
<section class="hero-section relative overflow-hidden" id="{{ section.id }}">
  <div class="flex flex-col-reverse lg:flex-row">
    {% comment %} Left blue section with text content - appears below image on mobile, left side on desktop {% endcomment %}
    <div class="w-full lg:w-1/2 relative" style="background-color: {{ hero.settings.background_color | default: '#0066cc' }};">
      <div class="flex md:justify-end px-4 md:px-6 lg:px-12 py-8 lg:py-12">
        <div class="md:max-w-xl">
          {% comment %} Rating stars and subtitle {% endcomment %}
          {% if hero.settings.show_stars or hero.settings.subtitle != blank %}
            <div class="flex items-center gap-2 mb-4">
              {% if hero.settings.show_stars %}
                <div class="flex gap-0.5">
                  {% for i in (1..5) %}
                    <svg class="w-3 h-3 lg:w-4 lg:h-4 fill-yellow-400" viewBox="0 0 16 16">
                      <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                    </svg>
                  {% endfor %}
                </div>
              {% endif %}
              {% if hero.settings.subtitle != blank %}
                <p class="text-xs lg:text-sm" style="color: {{ hero.settings.text_color | default: '#ffffff' }};">
                  {{ hero.settings.subtitle }}
                </p>
              {% endif %}
            </div>
          {% endif %}
          
          {% comment %} Main title {% endcomment %}
          {% if hero.settings.main_title != blank %}
            <h1 class="text-3xl lg:text-5xl font-bold mb-4 leading-tight" 
                style="color: {{ hero.settings.text_color | default: '#ffffff' }};">
              {{ hero.settings.main_title }}
            </h1>
          {% endif %}
          
          {% comment %} Benefit checkmarks {% endcomment %}
          <ul class="space-y-2 mb-6">
            {% for i in (1..4) %}
              {% assign check_setting = 'check_text_' | append: i %}
              {% assign check_text = hero.settings[check_setting] %}
              {% if check_text != blank %}
                <li class="flex items-start gap-2">
                  <span class="flex-shrink-0 w-4 h-4 lg:w-5 lg:h-5 rounded-full bg-green-500 flex items-center justify-center mt-0.5">
                    <svg class="w-2.5 h-2.5 lg:w-3 lg:h-3 text-white" viewBox="0 0 16 16" fill="currentColor">
                      <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
                    </svg>
                  </span>
                  <span class="text-sm lg:text-base" style="color: {{ hero.settings.text_color | default: '#ffffff' }};">
                    {{ check_text }}
                  </span>
                </li>
              {% endif %}
            {% endfor %}
          </ul>
          
          {% comment %} CTA Button {% endcomment %}
          {% if hero.settings.button_text != blank and hero.settings.button_url != blank %}
            <a href="{{ hero.settings.button_url }}" 
               class="inline-block px-6 lg:px-8 py-3 lg:py-4 bg-white text-blue-600 font-bold text-base lg:text-lg uppercase rounded-full shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200">
              {{ hero.settings.button_text }}
            </a>
          {% endif %}
          
          {% comment %} Money back guarantee {% endcomment %}
          {% if hero.settings.money_back_text != blank %}
            <div class="flex items-center gap-2 mt-4">
              <svg class="w-5 h-5 text-yellow-400" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/>
              </svg>
              <span class="text-xs lg:text-sm" style="color: {{ hero.settings.text_color | default: '#ffffff' }};">
                {{ hero.settings.money_back_text }}
              </span>
            </div>
          {% endif %}
          
          {% comment %} Timer for limited-time offers {% endcomment %}
          {% if hero.settings.show_timer and hero.settings.end_date != blank %}
            {% assign end_timestamp = hero.settings.end_date | date: '%s' | plus: 0 %}
            {% assign now_timestamp = 'now' | date: '%s' | plus: 0 %}
            {% if end_timestamp > now_timestamp %}
              <div class="mt-6 p-3 bg-black bg-opacity-20 rounded-lg inline-block"
                   data-countdown="{{ hero.settings.end_date }}"
                   data-countdown-end="{{ end_timestamp }}">
                <p class="text-xs mb-2 opacity-90">Limited Time Offer Ends In:</p>
                <div class="flex gap-3 text-center">
                  <div>
                    <div class="text-xl font-bold countdown-days">00</div>
                    <div class="text-[10px] uppercase opacity-75">Days</div>
                  </div>
                  <div>
                    <div class="text-xl font-bold countdown-hours">00</div>
                    <div class="text-[10px] uppercase opacity-75">Hours</div>
                  </div>
                  <div>
                    <div class="text-xl font-bold countdown-minutes">00</div>
                    <div class="text-[10px] uppercase opacity-75">Minutes</div>
                  </div>
                  <div>
                    <div class="text-xl font-bold countdown-seconds">00</div>
                    <div class="text-[10px] uppercase opacity-75">Seconds</div>
                  </div>
                </div>
              </div>
            {% endif %}
          {% endif %}
        </div>
      </div>
    </div>
    
    {% comment %} Right section with citrus background - appears above text on mobile, right side on desktop {% endcomment %}
    <div class="w-full lg:w-1/2 relative h-[400px] lg:h-auto">
      {% comment %} Use the main_image as the citrus background that fills the entire area {% endcomment %}
      {% if hero.settings.main_image != blank %}
        {{ hero.settings.main_image | image_url: width: 1200 | image_tag:
          loading: 'eager',
          fetchpriority: 'high',
          class: 'absolute inset-0 w-full h-full object-cover',
          widths: '600,800,1000,1200',
          sizes: '(max-width: 1024px) 100vw, 50vw'
        }}
      {% elsif hero.settings.background_image != blank %}
        {{ hero.settings.background_image | image_url: width: 1200 | image_tag:
          loading: 'eager',
          fetchpriority: 'high',
          class: 'absolute inset-0 w-full h-full object-cover',
          widths: '600,800,1000,1200',
          sizes: '(max-width: 1024px) 100vw, 50vw'
        }}
      {% else %}
        <div class="absolute inset-0 bg-gradient-to-br from-orange-300 to-yellow-300"></div>
      {% endif %}      
    </div>
  </div>
  
  {% comment %} Mobile swiper pagination dots {% endcomment %}
  {% if section.blocks.size > 1 and section.settings.show_pagination %}
    <div class="swiper-pagination absolute bottom-4 left-0 right-0 flex justify-center gap-2 lg:hidden"></div>
  {% endif %}
  
  {% comment %} Desktop navigation arrows {% endcomment %}
  {% if section.blocks.size > 1 and section.settings.show_arrows %}
    <button class="swiper-button-prev absolute left-4 top-1/2 -translate-y-1/2 w-10 h-10 bg-white bg-opacity-20 rounded-full items-center justify-center hover:bg-opacity-30 transition-colors hidden lg:flex">
      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"/>
      </svg>
    </button>
    <button class="swiper-button-next absolute right-4 top-1/2 -translate-y-1/2 w-10 h-10 bg-white bg-opacity-20 rounded-full items-center justify-center hover:bg-opacity-30 transition-colors hidden lg:flex">
      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
      </svg>
    </button>
  {% endif %}
</section>
{% endif %}

<style>
  #shopify-section-{{ section.id }} {
    margin-top: {{ section.settings.mobile_margin_top }}px;
    margin-bottom: {{ section.settings.mobile_margin_bottom }}px;
  }

  @media (min-width: 1024px) {
    #shopify-section-{{ section.id }} {
      margin-top: {{ section.settings.desktop_margin_top }}px;
      margin-bottom: {{ section.settings.desktop_margin_bottom }}px;
    }
  }
</style>

{% if hero.settings.show_timer and hero.settings.end_date != blank %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const countdownElements = document.querySelectorAll('[data-countdown]');
    
    countdownElements.forEach(function(element) {
      const endTime = parseInt(element.dataset.countdownEnd) * 1000;
      
      function updateCountdown() {
        const now = new Date().getTime();
        const distance = endTime - now;
        
        if (distance < 0) {
          element.style.display = 'none';
          return;
        }
        
        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);
        
        element.querySelector('.countdown-days').textContent = String(days).padStart(2, '0');
        element.querySelector('.countdown-hours').textContent = String(hours).padStart(2, '0');
        element.querySelector('.countdown-minutes').textContent = String(minutes).padStart(2, '0');
        element.querySelector('.countdown-seconds').textContent = String(seconds).padStart(2, '0');
      }
      
      updateCountdown();
      setInterval(updateCountdown, 1000);
    });
  });
</script>
{% endif %}

{% schema %}
{
  "name": "Hero Banner",
  "tag": "section",
  "class": "hero-banner",
  "settings": [
    {
      "type": "header",
      "content": "Desktop Spacing"
    },
    {
      "type": "range",
      "id": "desktop_margin_top",
      "label": "Margin Top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "desktop_margin_bottom",
      "label": "Margin Bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 0
    },
    {
      "type": "header",
      "content": "Mobile Spacing"
    },
    {
      "type": "range",
      "id": "mobile_margin_top",
      "label": "Mobile Margin Top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "mobile_margin_bottom",
      "label": "Mobile Margin Bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 0
    },
    {
      "type": "header",
      "content": "Navigation"
    },
    {
      "type": "checkbox",
      "id": "show_pagination",
      "label": "Show pagination dots (mobile)",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_arrows",
      "label": "Show navigation arrows (desktop)",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "hero_slide",
      "name": "Hero Slide",
      "settings": [
        {
          "type": "header",
          "content": "Campaign Settings"
        },
        {
          "type": "checkbox",
          "id": "is_default_hero",
          "label": "Default Hero",
          "info": "Check to make this the fallback hero when no timed campaigns are active"
        },
        {
          "type": "text",
          "id": "start_date",
          "label": "Start Date",
          "info": "Format: YYYY-MM-DD HH:MM (Eastern Time). Leave empty for always active."
        },
        {
          "type": "text",
          "id": "end_date",
          "label": "End Date",
          "info": "Format: YYYY-MM-DD HH:MM (Eastern Time). Leave empty for always active."
        },
        {
          "type": "checkbox",
          "id": "show_timer",
          "label": "Show countdown timer",
          "default": false,
          "info": "Displays a countdown to the end date"
        },
        {
          "type": "header",
          "content": "Design"
        },
        {
          "type": "color",
          "id": "background_color",
          "label": "Background Color (Left Section)",
          "default": "#0066cc"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Text Color",
          "default": "#ffffff"
        },
        {
          "type": "image_picker",
          "id": "background_image",
          "label": "Background Image (Right Section)",
          "info": "Fallback if main_image is not set. Citrus slices or pattern image"
        },
        {
          "type": "header",
          "content": "Content"
        },
        {
          "type": "text",
          "id": "main_title",
          "label": "Main Title",
          "default": "Transform Your Health"
        },
        {
          "type": "text",
          "id": "subtitle",
          "label": "Subtitle",
          "info": "Appears above the main title"
        },
        {
          "type": "checkbox",
          "id": "show_stars",
          "label": "Show rating stars",
          "default": true
        },
        {
          "type": "textarea",
          "id": "check_text_1",
          "label": "Benefit 1"
        },
        {
          "type": "textarea",
          "id": "check_text_2",
          "label": "Benefit 2"
        },
        {
          "type": "textarea",
          "id": "check_text_3",
          "label": "Benefit 3"
        },
        {
          "type": "textarea",
          "id": "check_text_4",
          "label": "Benefit 4"
        },
        {
          "type": "header",
          "content": "Call to Action"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button Text",
          "default": "SHOP NOW"
        },
        {
          "type": "url",
          "id": "button_url",
          "label": "Button Link"
        },
        {
          "type": "text",
          "id": "money_back_text",
          "label": "Guarantee Text",
          "placeholder": "60-DAY MONEY BACK GUARANTEE"
        },
        {
          "type": "header",
          "content": "Images"
        },
        {
          "type": "image_picker",
          "id": "main_image",
          "label": "Citrus Background Image",
          "info": "Full citrus background for right section (e.g., citrus slices)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Hero Banner",
      "blocks": [
        {
          "type": "hero_slide",
          "settings": {
            "is_default_hero": true,
            "main_title": "NEW Ageless Muscle® Citrus Splash",
            "subtitle": "Introducing",
            "show_stars": true,
            "check_text_1": "Bright, smooth, and refreshingly citrus flavored",
            "check_text_2": "Combat age-related muscle loss",
            "check_text_3": "Preserve and build lean muscle",
            "check_text_4": "Boost strength and recovery",
            "button_text": "SHOP NOW",
            "button_url": "/collections/all",
            "money_back_text": "60-DAY MONEY BACK GUARANTEE",
            "background_color": "#0066cc",
            "text_color": "#ffffff"
          }
        }
      ]
    }
  ]
}
{% endschema %}